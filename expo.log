+ exec gosu vibecode node node_modules/.bin/expo start --localhost
env: load .env
env: export EXPO_PUBLIC_VIBECODE_OPENAI_API_KEY EXPO_PUBLIC_VIBECODE_ANTHROPIC_API_KEY EXPO_PUBLIC_VIBECODE_GROK_API_KEY EXPO_PUBLIC_VIBECODE_GOOGLE_API_KEY EXPO_PUBLIC_VIBECODE_ELEVENLABS_API_KEY EXPO_PUBLIC_VIBECODE_FIREBASE_SERVER_KEY
Starting project at /home/user/workspace
Starting Metro Bundler
Waiting on http://localhost:8081
Logs for your project will appear below.
iOS ./index.ts â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  0.0% (0/1)
iOS ./index.ts â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  9.0% ( 40/178)
iOS ./index.ts â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 27.1% (327/659)
iOS ./index.ts â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 41.1% (549/856)
iOS ./index.ts â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 57.8% ( 834/1097)
iOS ./index.ts â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘ 78.0% (1102/1248)
iOS ./index.ts â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘ 94.3% (1388/1430)
iOS Bundled 23060ms index.ts (1475 modules)
 LOG  ğŸ”§ Firestore debug logging enabled
 ERROR  i18next::pluralResolver: Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.
 LOG  [index] Project ID is:  6d6cd6da-7505-42d7-91fd-2928c6600b00
 LOG  ğŸ” initializing state changed to: true
 LOG  ğŸ” Current state values: {"currentUser": false, "disableFirestoreForNewUsers": false, "initializing": true, "isNewUserRegistration": false, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: No user present, immediately showing auth screen
 LOG  ğŸ” setInitializing(false) called from: no user present
 LOG  ğŸ‘¤ WelcomeScreen: No user present, skipping timeout
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": false, "disableFirestoreForNewUsers": false, "initializing": false, "isNewUserRegistration": false, "mode": "select"}
 LOG  ğŸ”Š Haptic: medium impact
 LOG  ğŸ†• Creating user with clean data (no apartment ID): {"display_name": "×œ××—×™×§×”", "email": "del@gmail.com", "full_name": "×œ××—×™×§×”"}
 LOG  ğŸ“ Creating document in collection: users
 LOG  ğŸ“‹ Document data: {"display_name": "×œ××—×™×§×”", "email": "del@gmail.com", "full_name": "×œ××—×™×§×”"}
 LOG  ğŸ†” Document ID: otmf6ZDcYigiDhogNKzrD4YRyfS2
 LOG  ğŸ” Getting auth headers...
 LOG  â³ Waiting for authentication to be ready...
 LOG  ğŸ”‘ Getting current ID token...
 LOG  ğŸ”‘ Stored ID token: Present (eyJhbGciOiJSUzI1NiIs...)
 LOG  â° Token expires in 60 minutes
 LOG  âœ… ID token is valid
 LOG  âœ… Authentication is ready
 LOG  ğŸ” Token info: {"algorithm": "RS256", "email": "del@gmail.com", "expiresAt": "2025-10-09T19:06:59.000Z", "issuedAt": "2025-10-09T18:06:59.000Z", "type": "JWT", "userId": "otmf6ZDcYigiDhogNKzrD4YRyfS2"}
 LOG  âœ… Token project verified: roomies-hub
 LOG  âœ… Auth headers prepared successfully
 LOG  ğŸŒ Request URL: https://firestore.googleapis.com/v1/projects/roomies-hub/databases/(default)/documents/users?documentId=otmf6ZDcYigiDhogNKzrD4YRyfS2
 LOG  ğŸ“¤ Request body fields: ["email", "full_name", "display_name"]
 LOG  ğŸ“Š Response status: 200 ()
 LOG  Document created successfully: {"display_name": "×œ××—×™×§×”", "email": "del@gmail.com", "full_name": "×œ××—×™×§×”", "id": "otmf6ZDcYigiDhogNKzrD4YRyfS2"}
 LOG  ğŸ‰ Registration successful, calling onAuthSuccess immediately...
 LOG  ğŸ‰ User data being passed: {"current_apartment_id": null, "email": "del@gmail.com", "id": "otmf6ZDcYigiDhogNKzrD4YRyfS2"}
 LOG  ğŸ‰ onAuthSuccess function type: function
 LOG  ğŸ‰ onAuthSuccess function: [Function handleAuthSuccess]
 LOG  ğŸ‰ WelcomeScreen: handleAuthSuccess called!
 LOG  ğŸ‰ WelcomeScreen: Auth success, setting user and checking apartment...
 LOG  ğŸ‰ WelcomeScreen: User data: {"current_apartment_id": null, "email": "del@gmail.com", "id": "otmf6ZDcYigiDhogNKzrD4YRyfS2"}
 LOG  ğŸ‘¤ WelcomeScreen: New user detected (no apartment_id), skipping ALL Firestore operations
 LOG  ğŸ“­ WelcomeScreen: Directing new user to join/create apartment screen
 LOG  âœ… WelcomeScreen: Setting initializing to false for new user
 LOG  ğŸ” setInitializing(false) called from: handleAuthSuccess - new user
 LOG  âœ… WelcomeScreen: New user setup completed
 LOG  âœ… onAuthSuccess called successfully
 LOG  ğŸ” initializing state changed to: true
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": true, "isNewUserRegistration": false, "mode": "select"}
 LOG  ğŸ” External user detected, forcing navigation to join/create screen
 LOG  ğŸ” User data: {"current_apartment_id": null, "email": "del@gmail.com", "id": "otmf6ZDcYigiDhogNKzrD4YRyfS2"}
 LOG  ğŸ” New user detected externally, setting up...
 LOG  ğŸ” setInitializing(false) called from: external user detection
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ‘¤ WelcomeScreen: Skipping timeout for new user registration
 LOG  ğŸš€ Initializing Firebase notifications for user: otmf6ZDcYigiDhogNKzrD4YRyfS2
 LOG  ğŸš€ Initializing Firebase Web notification service...
 LOG  ğŸ“± Mobile platform - using mock token for testing
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ“± Mock FCM Token (for testing): mock_fcm_token_1760033220058_spjnzkvex
 LOG  ğŸ” Getting auth headers...
 LOG  â³ Waiting for authentication to be ready...
 LOG  ğŸ”‘ Getting current ID token...
 LOG  ğŸ”‘ Stored ID token: Present (eyJhbGciOiJSUzI1NiIs...)
 LOG  â° Token expires in 59 minutes
 LOG  âœ… ID token is valid
 LOG  âœ… Authentication is ready
 LOG  ğŸ” Token info: {"algorithm": "RS256", "email": "del@gmail.com", "expiresAt": "2025-10-09T19:06:59.000Z", "issuedAt": "2025-10-09T18:06:59.000Z", "type": "JWT", "userId": "otmf6ZDcYigiDhogNKzrD4YRyfS2"}
 LOG  âœ… Token project verified: roomies-hub
 LOG  âœ… Auth headers prepared successfully
 LOG  ğŸ” PATCH request details: {"body": "{
  \"fields\": {
    \"fcm_token\": {
      \"stringValue\": \"mock_fcm_token_1760033220058_spjnzkvex\"
    },
    \"device_type\": {
      \"stringValue\": \"ios\"
    },
    \"last_seen\": {
      \"stringValue\": \"2025-10-09T18:07:00.059Z\"
    }
  }
}", "updateMaskFields": ["fcm_token", "device_type", "last_seen"], "url": "https://firestore.googleapis.com/v1/projects/roomies-hub/databases/(default)/documents/users/otmf6ZDcYigiDhogNKzrD4YRyfS2?updateMask.fieldPaths=fcm_token&updateMask.fieldPaths=device_type&updateMask.fieldPaths=last_seen"}
 LOG  ğŸ”„ WelcomeScreen: Force re-render after 100ms
 LOG  ğŸ” setInitializing(false) called from: handleAuthSuccess - force re-render
 LOG  ğŸ”‘ Getting current ID token...
 LOG  ğŸ”‘ Stored ID token: Present (eyJhbGciOiJSUzI1NiIs...)
 LOG  â° Token expires in 59 minutes
 LOG  âœ… ID token is valid
 LOG  ğŸ”„ Additional fallback: Checking if user is set...
 LOG  âœ… Additional fallback: User found in store, navigation should work
 LOG  âœ… FCM token saved to Firestore
 LOG  ğŸ“± Mobile platform - notification listeners not available in Expo Go
 LOG  âœ… Firebase Web notification service initialized successfully
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: true
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": true, "isNewUserRegistration": false, "mode": "select"}
 LOG  ğŸ” External user detected, forcing navigation to join/create screen
 LOG  ğŸ” User data: {"current_apartment_id": null, "email": "del@gmail.com", "id": "otmf6ZDcYigiDhogNKzrD4YRyfS2"}
 LOG  ğŸ” New user detected externally, setting up...
 LOG  ğŸ” setInitializing(false) called from: external user detection
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ‘¤ WelcomeScreen: Skipping timeout for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: true
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": true, "isNewUserRegistration": false, "mode": "select"}
 LOG  ğŸ” External user detected, forcing navigation to join/create screen
 LOG  ğŸ” User data: {"current_apartment_id": null, "email": "del@gmail.com", "id": "otmf6ZDcYigiDhogNKzrD4YRyfS2"}
 LOG  ğŸ” New user detected externally, setting up...
 LOG  ğŸ” setInitializing(false) called from: external user detection
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ‘¤ WelcomeScreen: Skipping timeout for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: true
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": true, "isNewUserRegistration": false, "mode": "select"}
 LOG  ğŸ” External user detected, forcing navigation to join/create screen
 LOG  ğŸ” User data: {"current_apartment_id": null, "email": "del@gmail.com", "id": "otmf6ZDcYigiDhogNKzrD4YRyfS2"}
 LOG  ğŸ” New user detected externally, setting up...
 LOG  ğŸ” setInitializing(false) called from: external user detection
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ‘¤ WelcomeScreen: Skipping timeout for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: true
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": true, "isNewUserRegistration": false, "mode": "select"}
 LOG  ğŸ” External user detected, forcing navigation to join/create screen
 LOG  ğŸ” User data: {"current_apartment_id": null, "email": "del@gmail.com", "id": "otmf6ZDcYigiDhogNKzrD4YRyfS2"}
 LOG  ğŸ” New user detected externally, setting up...
 LOG  ğŸ” setInitializing(false) called from: external user detection
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ‘¤ WelcomeScreen: Skipping timeout for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: true
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": true, "isNewUserRegistration": false, "mode": "select"}
 LOG  ğŸ” External user detected, forcing navigation to join/create screen
 LOG  ğŸ” User data: {"current_apartment_id": null, "email": "del@gmail.com", "id": "otmf6ZDcYigiDhogNKzrD4YRyfS2"}
 LOG  ğŸ” New user detected externally, setting up...
 LOG  ğŸ” setInitializing(false) called from: external user detection
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ‘¤ WelcomeScreen: Skipping timeout for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: true
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": true, "isNewUserRegistration": false, "mode": "select"}
 LOG  ğŸ” External user detected, forcing navigation to join/create screen
 LOG  ğŸ” User data: {"current_apartment_id": null, "email": "del@gmail.com", "id": "otmf6ZDcYigiDhogNKzrD4YRyfS2"}
 LOG  ğŸ” New user detected externally, setting up...
 LOG  ğŸ” setInitializing(false) called from: external user detection
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ‘¤ WelcomeScreen: Skipping timeout for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: true
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": true, "isNewUserRegistration": false, "mode": "select"}
 LOG  ğŸ” External user detected, forcing navigation to join/create screen
 LOG  ğŸ” User data: {"current_apartment_id": null, "email": "del@gmail.com", "id": "otmf6ZDcYigiDhogNKzrD4YRyfS2"}
 LOG  ğŸ” New user detected externally, setting up...
 LOG  ğŸ” setInitializing(false) called from: external user detection
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ‘¤ WelcomeScreen: Skipping timeout for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: true
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": true, "isNewUserRegistration": false, "mode": "select"}
 LOG  ğŸ” External user detected, forcing navigation to join/create screen
 LOG  ğŸ” User data: {"current_apartment_id": null, "email": "del@gmail.com", "id": "otmf6ZDcYigiDhogNKzrD4YRyfS2"}
 LOG  ğŸ” New user detected externally, setting up...
 LOG  ğŸ” setInitializing(false) called from: external user detection
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ‘¤ WelcomeScreen: Skipping timeout for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 ERROR  i18next::pluralResolver: Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.
 LOG  ğŸ” initializing state changed to: true
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": true, "isNewUserRegistration": false, "mode": "select"}
 LOG  ğŸ” External user detected, forcing navigation to join/create screen
 LOG  ğŸ” User data: {"current_apartment_id": null, "email": "del@gmail.com", "id": "otmf6ZDcYigiDhogNKzrD4YRyfS2"}
 LOG  ğŸ” New user detected externally, setting up...
 LOG  ğŸ” setInitializing(false) called from: external user detection
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ‘¤ WelcomeScreen: Skipping timeout for new user registration
 LOG  ğŸš€ Initializing Firebase notifications for user: otmf6ZDcYigiDhogNKzrD4YRyfS2
 LOG  ğŸš€ Initializing Firebase Web notification service...
 LOG  ğŸ“± Mobile platform - using mock token for testing
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ“± Mock FCM Token (for testing): mock_fcm_token_1760033734402_d1esgey35
 LOG  ğŸ” Getting auth headers...
 LOG  â³ Waiting for authentication to be ready...
 LOG  ğŸ”‘ Getting current ID token...
 LOG  ğŸ”‘ Stored ID token: Present (eyJhbGciOiJSUzI1NiIs...)
 LOG  â° Token expires in 51 minutes
 LOG  âœ… ID token is valid
 LOG  âœ… Authentication is ready
 LOG  ğŸ” Token info: {"algorithm": "RS256", "email": "del@gmail.com", "expiresAt": "2025-10-09T19:06:59.000Z", "issuedAt": "2025-10-09T18:06:59.000Z", "type": "JWT", "userId": "otmf6ZDcYigiDhogNKzrD4YRyfS2"}
 LOG  âœ… Token project verified: roomies-hub
 LOG  âœ… Auth headers prepared successfully
 LOG  ğŸ” PATCH request details: {"body": "{
  \"fields\": {
    \"fcm_token\": {
      \"stringValue\": \"mock_fcm_token_1760033734402_d1esgey35\"
    },
    \"device_type\": {
      \"stringValue\": \"ios\"
    },
    \"last_seen\": {
      \"stringValue\": \"2025-10-09T18:15:34.402Z\"
    }
  }
}", "updateMaskFields": ["fcm_token", "device_type", "last_seen"], "url": "https://firestore.googleapis.com/v1/projects/roomies-hub/databases/(default)/documents/users/otmf6ZDcYigiDhogNKzrD4YRyfS2?updateMask.fieldPaths=fcm_token&updateMask.fieldPaths=device_type&updateMask.fieldPaths=last_seen"}
 LOG  âœ… FCM token saved to Firestore
 LOG  ğŸ“± Mobile platform - notification listeners not available in Expo Go
 LOG  âœ… Firebase Web notification service initialized successfully
 LOG  ğŸ” initializing state changed to: true
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": true, "isNewUserRegistration": false, "mode": "select"}
 LOG  ğŸ” External user detected, forcing navigation to join/create screen
 LOG  ğŸ” User data: {"current_apartment_id": null, "email": "del@gmail.com", "id": "otmf6ZDcYigiDhogNKzrD4YRyfS2"}
 LOG  ğŸ” New user detected externally, setting up...
 LOG  ğŸ” setInitializing(false) called from: external user detection
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ‘¤ WelcomeScreen: Skipping timeout for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: true
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": true, "isNewUserRegistration": false, "mode": "select"}
 LOG  ğŸ” External user detected, forcing navigation to join/create screen
 LOG  ğŸ” User data: {"current_apartment_id": null, "email": "del@gmail.com", "id": "otmf6ZDcYigiDhogNKzrD4YRyfS2"}
 LOG  ğŸ” New user detected externally, setting up...
 LOG  ğŸ” setInitializing(false) called from: external user detection
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ‘¤ WelcomeScreen: Skipping timeout for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: true
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": true, "isNewUserRegistration": false, "mode": "select"}
 LOG  ğŸ” External user detected, forcing navigation to join/create screen
 LOG  ğŸ” User data: {"current_apartment_id": null, "email": "del@gmail.com", "id": "otmf6ZDcYigiDhogNKzrD4YRyfS2"}
 LOG  ğŸ” New user detected externally, setting up...
 LOG  ğŸ” setInitializing(false) called from: external user detection
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ‘¤ WelcomeScreen: Skipping timeout for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "join"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "join"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: true
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": true, "isNewUserRegistration": false, "mode": "select"}
 LOG  ğŸ” External user detected, forcing navigation to join/create screen
 LOG  ğŸ” User data: {"current_apartment_id": null, "email": "del@gmail.com", "id": "otmf6ZDcYigiDhogNKzrD4YRyfS2"}
 LOG  ğŸ” New user detected externally, setting up...
 LOG  ğŸ” setInitializing(false) called from: external user detection
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ‘¤ WelcomeScreen: Skipping timeout for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "join"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "join"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "join"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "create"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "join"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "create"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "join"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "join"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "create"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "join"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "create"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "create"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "create"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "create"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "create"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "create"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "create"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "create"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "create"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "join"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ” initializing state changed to: true
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": true, "isNewUserRegistration": false, "mode": "select"}
 LOG  ğŸ” External user detected, forcing navigation to join/create screen
 LOG  ğŸ” User data: {"current_apartment_id": null, "email": "del@gmail.com", "id": "otmf6ZDcYigiDhogNKzrD4YRyfS2"}
 LOG  ğŸ” New user detected externally, setting up...
 LOG  ğŸ” setInitializing(false) called from: external user detection
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ‘¤ WelcomeScreen: Skipping timeout for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "create"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "join"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ” initializing state changed to: true
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": true, "isNewUserRegistration": false, "mode": "select"}
 LOG  ğŸ” External user detected, forcing navigation to join/create screen
 LOG  ğŸ” User data: {"current_apartment_id": null, "email": "del@gmail.com", "id": "otmf6ZDcYigiDhogNKzrD4YRyfS2"}
 LOG  ğŸ” New user detected externally, setting up...
 LOG  ğŸ” setInitializing(false) called from: external user detection
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ‘¤ WelcomeScreen: Skipping timeout for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "create"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "create"}
 LOG  ğŸ‘¤ WelcomeScreen: Skipping checkUserSession useEffect for new user registration
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "join"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "create"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "select"}
 LOG  ğŸ” initializing state changed to: false
 LOG  ğŸ” Current state values: {"currentUser": true, "disableFirestoreForNewUsers": true, "initializing": false, "isNewUserRegistration": true, "mode": "join"}
